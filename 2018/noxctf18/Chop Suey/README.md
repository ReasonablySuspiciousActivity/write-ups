# Chop Suey - Crypto
**Author:** Kaushik S Kalmady

```
Today I ate in a Chinese restaurant and got myself a fortune cookie. These things usually contain a note with a nice sentence or phrase, but mine had numbers in it instead! Can you help me find the meaning of the numbers?

p = 8637633767257008567099653486541091171320491509433615447539162437911244175885667806398411790524083553445158113502227745206205327690939504032994699902053229 
q = 12640674973996472769176047937170883420927050821480010581593137135372473880595613737337630629752577346147039284030082593490776630572584959954205336880228469 
dp = 6500795702216834621109042351193261530650043841056252930930949663358625016881832840728066026150264693076109354874099841380454881716097778307268116910582929 
dq = 783472263673553449019532580386470672380574033551303889137911760438881683674556098098256795673512201963002175438762767516968043599582527539160811120550041 
c = 24722305403887382073567316467649080662631552905960229399079107995602154418176056335800638887527614164073530437657085079676157350205351945222989351316076486573599576041978339872265925062764318536089007310270278526159678937431903862892400747915525118983959970607934142974736675784325993445942031372107342103852

```

This looked like a simple RSA challenge and googling what dp, dq are was all that was required. This [link](https://stackoverflow.com/questions/25446973/why-does-a-key-file-include-p-q-dp-dq) makes it extremely clear what we need to do.

```
dp = d mod (p-1)
dq = d mod (q-1)
```

We just need to solve the above two equations to get the private key `d` and decrypt `c`. The descriptions says something about a Chinese Restaurant so it should be fairly clear that we'll have to use the Chinese Remainder Theorem to solve the two equations.

We use an [online CRT solver](https://www.dcode.fr/chinese-remainder) to obtain the value of d.
>14836265939124651169343266649666716075977732399209476083320545444536408482893918427740189725187780209158920804690773646700597134949201731810391733653802149074136118237088896136095953383818585721087130205414392257537421414730489651489649141061606772980903278498673596605318207017135467743153947745898452183981L

Now we just have to decrypt `c` and obtain the flag.


```python
import binascii
ans = pow(c, d, p*q)
print(binascii.unhexlify(hex(ans)[2:][:-1])
```

>'noxCTF{W31c0m3_70_Ch1n470wn}'
